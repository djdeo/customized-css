<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Lazyload Image</title>
    <style>
    body{
        max-width: 960px;
        margin:0 auto;
        font-family: 'Courier New', Courier, monospace;
        display: flex;
        flex-direction: column;
    }
    img{display: block; margin:0 auto; justify-content: center;}
   figcaption {text-align: center; padding-top: .5rem; font-style: italic}
   p{padding:2rem 0;}

    h1 {padding-top: 5rem;font-size: 4rem;}
    </style>
</head>
<body>
    <h1>Lazyload Image</h1>
    <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Obcaecati, cumque? Lorem ipsum dolor sit amet consectetur adipisicing elit. Incidunt esse dignissimos magni aliquid impedit quisquam repellendus culpa inventore.</p>
    <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Obcaecati, cumque? Lorem ipsum dolor sit amet consectetur adipisicing elit. Incidunt esse dignissimos magni aliquid impedit quisquam repellendus culpa inventore.</p>
    <p>Lorem ipsum, dolor sit amet consectetur adipisicing elit. Quae eum nemo exercitationem vel modi sint voluptate quia. Ex ut neque animi quos non dolore nesciunt quidem ad assumenda labore consequuntur, sequi quam ea placeat repellat hic incidunt minus, sunt voluptate officia cum sapiente! Suscipit nam dolores sapiente magni eligendi doloremque? Maiores corporis amet repellendus temporibus sint, voluptatum impedit laboriosam doloremque distinctio rem neque maxime harum recusandae, molestiae expedita deleniti magnam asperiores natus sapiente debitis. Vero cum quidem magnam eligendi sunt.</p>
    <p>Lorem ipsum, dolor sit amet consectetur adipisicing elit. Quae eum nemo exercitationem vel modi sint voluptate quia. Ex ut neque animi quos non dolore nesciunt quidem ad assumenda labore consequuntur, sequi quam ea placeat repellat hic incidunt minus, sunt voluptate officia cum sapiente! Suscipit nam dolores sapiente magni eligendi doloremque? Maiores corporis amet repellendus temporibus sint, voluptatum impedit laboriosam doloremque distinctio rem neque maxime harum recusandae, molestiae expedita deleniti magnam asperiores natus sapiente debitis. Vero cum quidem magnam eligendi sunt.</p>

    <figure>
        <img src="thumbnail.webp" alt="thumbnail" data-src="https://res.cloudinary.com/drp9iwjqz/image/upload/f_auto,q_auto/v1509298941/jeremywagner.me/about/st-paul-2x.jpg" class="lazyload">
        <figcaption>Image caption 1</figcaption>
    </figure>
    <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Similique corrupti odio eaque incidunt fuga minus? Lorem ipsum dolor, sit amet consectetur adipisicing elit.</p>
    <figure>
        <img src="thumbnail.webp" alt="thumbnail" data-src="https://res.cloudinary.com/drp9iwjqz/image/upload/f_auto,q_auto/v1509298941/jeremywagner.me/about/st-paul-2x.jpg" class="lazyload">
        <figcaption>Image caption 2</figcaption>
    </figure>
    <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Similique corrupti odio eaque incidunt fuga minus? Lorem ipsum dolor, sit amet consectetur adipisicing elit.</p>
    <figure>
        <img src="thumbnail.webp" alt="thumbnail" data-src="https://res.cloudinary.com/drp9iwjqz/image/upload/f_auto,q_auto/v1509298941/jeremywagner.me/about/st-paul-2x.jpg" class="lazyload">
        <figcaption>Image caption 3</figcaption>
    </figure>
    <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Similique corrupti odio eaque incidunt fuga minus? Lorem ipsum dolor, sit amet consectetur adipisicing elit.</p>
    <figure>
        <img src="thumbnail.webp" alt="thumbnail" data-src="https://res.cloudinary.com/drp9iwjqz/image/upload/f_auto,q_auto/v1509298941/jeremywagner.me/about/st-paul-2x.jpg" class="lazyload">
        <figcaption>Image caption 4</figcaption>
    </figure>
    <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Similique corrupti odio eaque incidunt fuga minus? Lorem ipsum dolor, sit amet consectetur adipisicing elit.</p>

    <p>Check google's <a href="https://developers.google.com/web/fundamentals/performance/lazy-loading-guidance/images-and-video/
">guide on lazyload</a></p>

    <script>
    function lazyLoadImg() {
        var lazyImages = [].slice.call(document.querySelectorAll("img.lazyload"));
        var imageCaptions = [].slice.call(document.querySelectorAll("figcaption"));

        if ("IntersectionObserver" in window) {
            let lazyImageOberser = new IntersectionObserver(function(entries, observer){
                entries.forEach(function(entry) {
                    if (entry.isIntersecting) {
                        let lazyImage = entry.target;
                        lazyImage.src = lazyImage.dataset.src;
                        lazyImage.classList.remove("lazyload");
                        lazyImageOberser.unobserve(lazyImage);
                    }
                });
            });

            lazyImages.forEach(function(lazyImage){
                lazyImageOberser.observe(lazyImage);
            });
        } else {
            imageCaptions.forEach(function(imageCaption){
                imageCaption.innerText = "IE 11 not supported"
            })
        }
    }

    window.onload = lazyLoadImg();
    
    </script>
</body>
</html>